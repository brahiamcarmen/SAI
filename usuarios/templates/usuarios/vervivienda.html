{% extends 'usuarios/base_usuario3.html' %}
{% load static %}
{% block styles %}
{% endblock %}
{% load humanize %}
{%block title %} <title>Modulo - VIP</title> {%endblock%}
{% block content %}
{% include 'usuarios/alerts.html' %}

<div class="page-body">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                  <ul class="nav nav-tabs" data-bs-toggle="tabs">
                    <li class="nav-item">
                      <a href="#tabs-home-7" class="nav-link active" data-bs-toggle="tab">Inicio</a>
                    </li>
                    <li class="nav-item">
                      <a href="#tabs-profile-7" class="nav-link" data-bs-toggle="tab">Informacion detallada</a>
                    </li>
                    <li class="nav-item">
                      <a href="#facturas" class="nav-link" data-bs-toggle="tab">Facturas</a>
                    </li>
                    <li class="nav-item">
                      <a href="#conceptos" class="nav-link" data-bs-toggle="tab">Conceptos de cobro</a>
                    </li>
                    <li class="nav-item">
                      <a href="#novedadesp" class="nav-link" data-bs-toggle="tab">Novedades</a>
                    </li>
                    <li class="nav-item">
                      <a href="#suspenciones" class="nav-link" data-bs-toggle="tab">Suspenciones</a>
                    </li>
                    <li class="nav-item">
                      <a href="#reconexiones" class="nav-link" data-bs-toggle="tab">Reconexiones</a>
                    </li>
                    <li class="nav-item">
                      <a href="#ocobros" class="nav-link" data-bs-toggle="tab">Otros cobros</a>
                    </li>
                    <li class="nav-item ms-auto">
                      <a href="#tabs-settings-7" class="nav-link" title="Settings" data-bs-toggle="tab"><!-- Download SVG icon from http://tabler-icons.io/i/settings -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" /><circle cx="12" cy="12" r="3" /></svg>
                      </a>
                    </li>
                  </ul>
                  <div class="card-body">
                    <div class="tab-content">
                      <div class="tab-pane active show" id="tabs-home-7">
                        <div>
                            <div class="row">
                                <div class="col-xl-12">
                                    <div class="row">
                                        <div class="col-md-4 col-lg-3">
                                            <div class="card">
                                              <div class="card-body p-4 text-center">
                                                <span class="avatar avatar-xl mb-3 avatar-rounded" style="background-image: url({% static 'images/logo2.png' %})"></span>
                                                <h3 class="m-0 mb-1">{{ matricula }}</h3>
                                                <div class="text-muted"><a href="{% url 'usuarios:verpropietario' propietario.IdPropietario %}">{{ propietario }}</a></div>
                                                <div class="mt-3">
                                                    <span class="badge bg-purple-lt">{{ estado }}</span>&nbsp; 
                                                    <span class="badge bg-purple-lt">{{ tipo }}</span>&nbsp; 
                                                    <span class="badge bg-purple-lt">{{ tipop }}</span>
                                                </div>
                                              </div>
                                              <div class="d-flex">
                                                <a href="{% url 'usuarios:modificarvivienda' matricula %}" class="card-btn"><!-- Download SVG icon from http://tabler-icons.io/i/pencil -->
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" /><line x1="13.5" y1="6.5" x2="17.5" y2="10.5" /></svg>
                                                  Modificar informacion</a>
                                                <a href="{% url 'usuarios:cambioestado' matricula %}" class="card-btn btn-groups"><!-- Download SVG icon from http://tabler-icons.io/i/power -->
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 6a7.75 7.75 0 1 0 10 0" /><line x1="12" y1="4" x2="12" y2="12" /></svg>
                                                  Estado servicio</a>
                                              </div>
                                            </div>
                                          </div>
                                          <div class="col-md-4 col-lg-6">
                                            <div class="row" style="margin-top:0.5rem">
                                                <div class="col-8">
                                                    <h3 class="subheader">Ubicacion del predio</h3>
                                                    <div class="row text-center">
                                                        <div class="col-4 col-sm-4">
                                                            <b class="text-primary">Sector</b><br>
                                                            {{ direccion }}
                                                        </div>
                                                        <div class="col-4 col-sm-4">
                                                            <b class="text-primary">Casa</b><br>
                                                            {{ casa }}
                                                        </div>
                                                        <div class="col-4 col-sm-4">
                                                            <b class="text-primary">Piso</b><br>
                                                            {{ piso }}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-4">
                                                    <div class="row">
                                                        {% if filtro is True %}
                                                       <div class="card card-sm">
                                                          <div class="card-body">
                                                            <div class="row align-items-center">
                                                              <div class="col-auto">
                                                                <span class="bg-red text-white avatar"><!-- Download SVG icon from http://tabler-icons.io/i/shopping-cart -->
                                                                  <!-- Download SVG icon from http://tabler-icons.io/i/scissors -->
                                                                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="6" cy="7" r="3" /><circle cx="6" cy="17" r="3" /><line x1="8.6" y1="8.6" x2="19" y2="19" /><line x1="8.6" y1="15.4" x2="19" y2="5" /></svg>
                                                                </span>
                                                              </div>
                                                              <div class="col">
                                                                <div class="font-weight-medium">
                                                                  Con orden de suspenci√≥n
                                                                </div>
                                                              </div>
                                                            </div>
                                                          </div>
                                                        </div>
                                                        {% else %}
                                                            {% if total <= 0 %}
                                                            <div class="card card-sm">
                                                              <div class="card-body">
                                                                <div class="row align-items-center">
                                                                  <div class="col-auto">
                                                                    <span class="bg-green text-white avatar"><!-- Download SVG icon from http://tabler-icons.io/i/checks -->
                                                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 12l5 5l10 -10" /><path d="M2 12l5 5m5 -5l5 -5" /></svg>
                                                                    </span>
                                                                  </div>
                                                                  <div class="col">
                                                                    <div class="font-weight-medium">
                                                                    Al dia - Sin novedad
                                                                    </div>
                                                                  </div>
                                                                </div>
                                                              </div>
                                                            </div>
                                                            {% else %}
                                                                <div class="card card-sm">
                                                                  <div class="card-body">
                                                                    <div class="row align-items-center">
                                                                      <div class="col-auto">
                                                                        <span class="bg-orange text-white avatar"><!-- Download SVG icon from http://tabler-icons.io/i/alert-octagon -->
                                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8.7 3h6.6c.3 0 .5 .1 .7 .3l4.7 4.7c.2 .2 .3 .4 .3 .7v6.6c0 .3 -.1 .5 -.3 .7l-4.7 4.7c-.2 .2 -.4 .3 -.7 .3h-6.6c-.3 0 -.5 -.1 -.7 -.3l-4.7 -4.7c-.2 -.2 -.3 -.4 -.3 -.7v-6.6c0 -.3 .1 -.5 .3 -.7l4.7 -4.7c.2 -.2 .4 -.3 .7 -.3z" /><line x1="12" y1="8" x2="12" y2="12" /><line x1="12" y1="16" x2="12.01" y2="16" /></svg>
                                                                        </span>
                                                                      </div>
                                                                      <div class="col">
                                                                        <div class="font-weight-medium">
                                                                            Con pagos pendientes
                                                                        </div>
                                                                      </div>
                                                                    </div>
                                                                  </div>
                                                                </div>
                                                            {% endif %}
                                                        {% endif %}
                                                    </div>
                                                </div>
                                            </div>
                                    <br>
                                    <div class="row" style="margin-top:0.5rem">
                                        <div class="col-6">
                                            <h3 class="subheader">Ultima factura</h3>
                                            {% for factura in facturasemi %}
                                            <div class="card">
                                              <div class="card-body p-4 text-center">
                                                <h3 class="m-0 mb-1">{{ factura.IdFactura }}</h3>
                                                <div class="text-muted">{{ factura.IdCiclo }}</div>
                                                <div class="mt-3">
                                                    {% if factura.Estado == "Vencida" %}
                                                    <span class="badge bg-warging-lt">Vencida</span>&nbsp;
                                                    {% elif factura.Estado == "Paga" %}
                                                     <span class="badge bg-success-lt">Paga</span>&nbsp;
                                                     {% elif factura.Estado == "Anulada" %}
                                                    <span class="badge bg-purple-lt">Anulada</span>&nbsp;
                                                    {% else %}
                                                    <span class="badge bg-info-lt">Emitida</span>
                                                    {% endif %}
                                                </div>
                                              </div>
                                              <div class="d-flex">
                                                <a href="{% url 'usuarios:descargarfactura' factura.IdFactura %}" class="card-btn">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><polyline points="7 11 12 16 17 11" /><line x1="12" y1="4" x2="12" y2="16" /></svg>&nbsp; Descargar
                                                  </a>
                                              </div>
                                            </div>
                                            {% endfor %}
                                        </div>
                                        <div class="col-6">
                                            <h3 class="subheader">Ultimo pago</h3>
                                            {%for filtropago in ultimopago %}
                                            <div class="card">
                                              <div class="card-body p-4 text-center">
                                                <h3 class="m-0 mb-1">{{ filtropago.IdPago }}</h3>
                                                <div class="text-muted"> {{filtropago.FechaPago}}  </div>
                                                <div class="mt-3">
                                                    <span class="badge bg-warging-lt">{{ filtropago.IdFactura }}</span>&nbsp;
                                                    <span class="badge bg-warging-lt">${{ filtropago.ValorPago|intcomma }}</span>&nbsp;
                                                </div>
                                              </div>
                                              <div class="d-flex">
                                                <a href="{% url 'usuarios:imprimirpago' filtropago.IdPago %}" class="card-btn">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2" /><path d="M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4" /><rect x="7" y="13" width="10" height="8" rx="2" /></svg>&nbsp; Imprimir
                                                  </a>
                                              </div>
                                            </div>
                                            {% endfor %}
                                        </div>
                                     </div>
                                    <br>
                                          </div>
                                          <div class="col-md-4 col-lg-3">
                                            <h3 class="subheader">Estado de cuenta</h3>
                                             <table class="table table-transparent table-responsive">
                                              <thead>
                                                <tr>
                                                  <th>Descripci√≥n</th>
                                                  <th class="text-end" style="width: 1%">Cuotas</th>
                                                  <th class="text-end" style="width: 1%">Valor</th>
                                                </tr>
                                              </thead>
                                              <tr>
                                                <td>
                                                  <p class="strong mb-1">Aportes</p>
                                                  <div class="text-muted">{{estadocuenta}}</div>
                                                </td>
                                                <td class="text-end">0</td>
                                                <td class="text-end"> ${{ aportes|intcomma }}</td>
                                              </tr>
                                              <tr>
                                                <td>
                                                  <p class="strong mb-1">Matricula</p>
                                                  <div class="text-muted">{{nocuenta}}</div>
                                                </td>
                                                <td class="text-end">0</td>
                                                <td class="text-end"> ${{ cobromatricula1|intcomma }}</td>
                                              </tr>
                                              <tr>
                                                <td>
                                                  <p class="strong mb-1">Suspenci√≥n</p>
                                                  <div class="text-muted">Auto</div>
                                                </td>
                                                <td class="text-end">0</td>
                                                <td class="text-end"> ${{ suspenciones2|intcomma }}</td>
                                              </tr>
                                              <tr>
                                                <td>
                                                  <p class="strong mb-1">Reconexi√≥n</p>
                                                  <div class="text-muted">Auto</div>
                                                </td>
                                                <td class="text-end">0</td>
                                                <td class="text-end"> ${{ reconexion2|intcomma }}</td>
                                              </tr>
                                              <tr>
                                                <td>
                                                  <p class="strong mb-1">Reparaciones</p>
                                                  <div class="text-muted">Auto</div>
                                                </td>
                                                <td class="text-end">0</td>
                                                <td class="text-end"> $0</td>

                                              <tr>
                                                <td colspan="2" class="font-weight-bold text-uppercase text-end">Total</td>
                                                <td class="font-weight-bold text-end">${{total|intcomma}}</td>
                                              </tr>
                                            </table>
                                          </div>
                                        </div>
                                </div>
                            </div>
                        </div>
                      </div>
                      <div class="tab-pane" id="tabs-profile-7">
            <div class="row" style="margin-top:0.5rem">
                <div class="col-sm-9 text-center">
                                <div class="card shadow mb-4">
                                    <div class="card-header py-3">
                                                <h6 class="m-0 font-weight-bold text-primary">Informaci√≥n detallada del predio</h6>
                                    </div>
                                    {% for vivienda in viviendainfo %}
                                    <div class="card shadow h-100 py-2">
                                        <div class="row">
                                            <div class="col-sm-3">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                             Matricula</div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ vivienda.IdVivienda }}</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-3">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Estado servicio</div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ vivienda.EstadoServicio }}</div>
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-3">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Tipo instalacion
                                                    </div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ vivienda.TipoInstalacion }}</div>
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-3">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Tipo predio
                                                    </div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ vivienda.InfoInstalacion }}</div>
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-sm-3">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                             <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                           Sector
                                                            </div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ vivienda.Direccion }}</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-2">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Casa</div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ vivienda.NumeroCasa }}</div>
                                                            
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-2">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                           <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Piso
                                                            </div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ vivienda.Piso }}</div>
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-2">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Estrato
                                                            </div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ vivienda.Estrato }}</div>
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-3">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Ficha catastral
                                                            </div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{vivienda.FichaCastral}}</div>
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-3">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                             <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                                Propietario
                                                            </div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ vivienda.IdPropietario }}</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-2">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Habitantes</div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ vivienda.CantHabitantes }}</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-3">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                           <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Prof. acometida (cm)
                                                            </div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ vivienda.ProfAcometida }}</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-2">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Ciclo
                                                            </div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ vivienda.Ciclo }}</div>
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-2">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Predios
                                                            </div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ vivienda.CantPredios }}</div>
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                </div>
                <div class="col-sm-3 text-center">
                            <div class="card shadow mb-4">
                                    <div class="card-header py-3">
                                        <h6 class="m-0 font-weight-bold text-primary">Calificaci√≥n</h6>
                                    </div>
                                    <div class="card shadow h-100 py-2">
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Puntos
                                                    </div>
                                                    <div style="color:rgba(65,160,39); font-size: 1.3rem;"><b>100</b></div>
                                                </div>
                                            </div>
                                            <div class="row" style="margin-top:0.4rem; font-size: 2rem;">
                                                <div class="col-sm-4">
                                                    <i class="fas fa-star"></i>
                                                </div>
                                                <div class="col-sm-4">
                                                    <i class="fas fa-star-half-alt"></i>
                                                </div>
                                                <div class="col-sm-4">
                                                    <i class="far fa-star"></i>
                                                </div>
                                            </div>
                                            <div class="row" style="margin-top:0.4rem;">
                                               <p>Los resultados de esta evaluaci√≥n se analizan con inteligencia artificial teniendo en cuenta los patrones de pago.</p>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                </div>
                            </div>
                                        <div class="row" style="margin-top:0.2rem">
                <div class="col-sm-12 text-center">
                                <div class="card shadow mb-4">
                                    <div class="card-header py-3">
                                                <h6 class="m-0 font-weight-bold text-primary">Certificaci√≥n</h6>
                                    </div>
                                    {% for certificacion in certificaciones %}
                                    <div class="card shadow h-100 py-2">
                                        <div class="row">
                                            <div class="col-sm-2">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                             Codigo</div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ certificacion.IdCertificacion }}</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-3">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Nit certificadora</div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ certificacion.Nit }}</div>
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-7">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Raz√≥n social certificadora
                                                    </div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ certificacion.NombreEmpresa}}</div>
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                             <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                           Descripcion
                                                            </div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">
                                                                {{ certificacion.Descripcion }}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Estado</div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ certificacion.Estado }}</div>
                                                            
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="card-body">
                                                    <div class="row no-gutters align-items-center">
                                                        <div class="col mr-2">
                                                           <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                            Cumple requisitos
                                                            </div>
                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ certificacion.Soporte}}</div>
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {% empty %}
                                        <div class="col-sm-12">
                                            <p>predio sin proceso de certificacion</p>
                                        </div>
                                    {% endfor %}
                                </div>
                                </div>
                            </div>

                            <div class="row" style="margin-top:0.5rem">
                                <div class="col-sm-12 text-center">
                                    <div class="card shadow mb-4">
                                                    <div class="card-header py-3">
                                                        <h6 class="m-0 font-weight-bold text-primary">Informaci√≥n del medidor</h6>
                                                    </div>
                                                    {% for medidor in medidores %}
                                                    <div class="card shadow h-100 py-2">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <div class="card-body">
                                                                    <div class="row no-gutters align-items-center">
                                                                        <div class="col mr-2">
                                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                                             Codigo</div>
                                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ medidor.IdMedidor }}</div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-3">
                                                                <div class="card-body">
                                                                    <div class="row no-gutters align-items-center">
                                                                        <div class="col mr-2">
                                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                                            Marca</div>
                                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ medidor.Marca }}</div>
                                                                        </div>
                                                                        
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-3">
                                                                <div class="card-body">
                                                                    <div class="row no-gutters align-items-center">
                                                                        <div class="col mr-2">
                                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                                            Tipo
                                                                            </div>
                                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ medidor.Tipo }}</div>
                                                                        </div>
                                                                        
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-3">
                                                                <div class="card-body">
                                                                    <div class="row no-gutters align-items-center">
                                                                        <div class="col mr-2">
                                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                                            Lectura inicial
                                                                            </div>
                                                                            <div class="mb-0 font-weight-bold text-gray-800">{{ medidor.LecturaInicial }}</div>
                                                                        </div>
                                                                        
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-sm-12">
                                                                <div class="card-body">
                                                                    <div class="row no-gutters align-items-center">
                                                                        <div class="col mr-2">
                                                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                                            A√±o de fabricacion
                                                                            </div>
                                                                            <div class="mb-0 font-weight-bold text-gray-800">
                                                                              {{ medidor.AnoFabricacion }}
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                        {% empty %}
                                            <div class="col-sm-12" style="margin-top:0.5rem;">
                                                <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                     <p>Predio sin medidor asignado</p>
                                                </div>
                                               
                                            </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>

                            <div class="row" style="margin-top:0.5rem">
                                <div class="col-sm-12 text-center">
                                    <div class="row">

                                        <div class="col-sm-4">
                                            <div class="card shadow mb-4">
                                                <div class="card-header py-3">
                                                    <h6 class="m-0 font-weight-bold text-primary">Certificado</h6>
                                                </div>
                                                <div class="card-body">
                                                    <form action="{% url 'usuarios:certificadogral' %}" method="get" class="form-inline">
                                                        {% csrf_token %}
                                                        <input type ="hidden" name="matricula" value="{{matricula}}" class="form-control">
                                                        <br>
                                                        <button style="margin-top: 0.3rem; width: 100%" type="submit" class="btn btn-sm btn-primary">Descargar</button>
                                                    </form>
                                                </div>         
                                            </div>
                                        </div>

                                    </div>
                                   
                                </div>
                            </div>


                                      </div>

                      <div class="tab-pane" id="facturas">
                        <div>
                            <div class="page-header d-print-none">
                                <div class="row align-items-center">
                                  <div class="col">
                                    <h2 class="page-title">
                                    Facturas registradas
                                    </h2>
                                    <div class="text-muted mt-1">{{nofac}}</div>
                                  </div>
                                  <!-- Page title actions -->
                                </div>
                              </div>
                            <div class="page-body">
                                  <div class="container-xl">
                                    <div class="row row-cards">
                                    {% for factura in facturas %} 
                                      <div class="col-md-6 col-lg-3">
                                        <div class="card" style="background-color: #EAFAF1;">
                                          <div class="card-body p-4 text-center">
                                            <h3 class="m-0 mb-1"><a href="{% url 'usuarios:descargarfactura' factura.IdFactura %}">{{ factura.IdFactura }}</a></h3>
                                            <div class="text-muted">{{ factura.IdCiclo }}</div>
                                            <div class="mt-3">
                                                {% if factura.Estado == "Vencida" %}
                                                <span class="badge bg-danger-lt">Vencida</span>
                                                {% elif factura.Estado == "Paga" %}
                                                <span class="badge bg-success-lt">Paga</span>
                                                {% elif factura.Estado == "Anulada" %}
                                                <span class="badge bg-warging-lt">Paga</span>
                                                {% else %}
                                                <span class="badge bg-info-lt">Emitida</span>
                                                {% endif %}
                                            </div>
                                            <div class="text-muted">${{ factura.Total|intcomma }}</div>
                                            <hr>
                                            <div class="row"  style="font-size:13px">
                                            {% for pago in pagos %}  
                                                {% if factura.IdFactura == pago.IdFactura.pk %}
                                                <div class="col-sm-6">
                                                    <b class="text-primary"># Pago</b><br>
                                                    <a href="{% url 'usuarios:imprimirpago' pago.IdPago %}">{{ pago.IdPago }}</a>
                                                </div>
                                                <div class="col-sm-6">
                                                    <b class="text-primary">Valor</b><br>
                                                    ${{ pago.ValorPago|intcomma }}
                                                </div>
                                                <div class="col-sm-12">
                                                    <b class="text-primary">Resta</b><br>
                                                    ${{ pago.resta|intcomma }}
                                                </div>
                                                <div class="col-sm-12">
                                                    <b class="text-primary">Fecha de pago</b><br>
                                                    <p >{{ pago.FechaPago }}</p>
                                                </div>
                                                {% else %}
                                                <!-- pagos registrados por factura -->
                                                {% endif %}
                                            {% endfor %}
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    {%endfor%}
                                    </div>
                                  </div>
                                </div>


                        </div>
                      </div>
                      <div class="tab-pane" id="conceptos">
                        <div class="row">
                            {% for matricula in matriculas %}
                            <div class="col-md-6 col-lg-6">
                                        <div class="card">
                                          <div class="card-body p-4 text-center">
                                            <div class="row">
                                                <div class="col-6">
                                                    <h3 class="m-0 mb-1"><a href="">Cargo por conexi√≥n:</a></h3>
                                                   
                                                </div>
                                                <div class="col-6">
                                                    <div class="text-muted">{{ matricula.IdCobroM }}</div>
                                                </div>
                                            </div>
                                            <hr>
                                            <div class="row">
                                                <div class="col-4">
                                                    <b>Descripcion</b><br>
                                                    {{ matricula.Descripcion }}
                                                </div>
                                                <div class="col-4">
                                                    <b>Estado</b><br>
                                                    {% if matricula.Estado == "Pago" %}
                                                    <span class="badge bg-success-lt">Pago</span>
                                                    {% else %}
                                                    <span class="badge bg-info-lt">Pendiente</span>
                                                    {% endif %}
                                                </div>
                                                <div class="col-4">
                                                    <b>Valor</b><br>
                                                    ${{ matricula.IdValor|intcomma }}
                                                </div>
                                            </div>
                                            <hr>
                                            <div class="row">
                                                <div class="col-sm-12 text-success"><b>Financiaci√≥n</b></div>
                                            </div>
                                            <br>
                                            <div class="row">
                                                <div class="col-4">
                                                    <b>Total cuotas</b><br>
                                                    {{ matricula.CantCuotas }}
                                                </div>
                                                <div class="col-4">
                                                    <b>Cuotas Pendientes</b><br>
                                                    {{ matricula.CuotasPendientes }}
                                                </div>
                                                <div class="col-4">
                                                    <b>Valor Pendiente</b><br>
                                                    {{ matricula.ValorPendiente }}
                                                </div>
                                            </div>
                                            <br>
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <b>Valor cuota</b><br>
                                                    ${{ matricula.Cuota|intcomma }}
                                                </div>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                            {%endfor%}
                            {% for estados in estados %}
                            <div class="col-md-6 col-lg-6">
                                        <div class="card">
                                          <div class="card-body p-4 text-center">
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <h3 class="m-0 mb-1"><a href="">Cuenta de aportes:</a></h3>
                                                   
                                                </div>
                                                <div class="col-sm-6">
                                                    <div class="text-muted">{{ estados.IdEstadoCuenta }}</div>
                                                </div>
                                            </div>
                                            <hr>
                                            <div class="row">
                                                <div class="col-4">
                                                    <b>Descripcion</b><br>
                                                    {{ estados.Descripcion }}
                                                </div>
                                                <div class="col-4">
                                                    <b>Estado</b><br>
                                                    {% if estados.Estado == "Operativo" %}
                                                    <span class="badge bg-success-lt">Operativo</span>
                                                    {% else %}
                                                    {{estados.Estado}}
                                                    {% endif %}
                                                </div>
                                                <div class="col-4">
                                                    <b>Valor</b><br>
                                                   ${{ estados.Valor|intcomma }}
                                                </div>
                                            </div>
                                            <hr>
                                            <br>
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <b>Fecha de actualizaci√≥n</b><br>
                                                    {{ estados.FechaActualizacion }}
                                                </div>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                            {%endfor %}
                        </div>
                      </div>
                      <div class="tab-pane" id="novedadesp">
                <div class="row" style="margin-top:0.5rem; font-size: 0.8rem;">
                    {% for novedad in novedades %}
                        <div class="col-sm-4 text-center" style="margin-top: 0.5rem;">
                            <div class="card text-center">
                                <div class="card-header">
                                    <b class="text-primary">Numero de novedad: </b>{{ novedad.IdNovedad  }}
                                </div>

                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-sm-6">
                                            <b class="text-primary">Fecha</b><br>
                                            {{ novedad.Fecha }}
                                        </div>
                                        <div class="col-sm-6">
                                            <b class="text-primary">Tipo novedad</b><br>
                                            {{ novedad.TipoNovedad  }}       
                                        </div>
                                    </div>
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <b class="text-primary">usuario</b><br>
                                                        {{ novedad.usuid }}
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <b class="text-primary">Total</b><br>
                                                        ${{ novedad.Valor|intcomma }}
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-12">
                                                        <b class="text-primary">Descripcion</b><br>
                                                        {{ novedad.Descripcion }}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="tab-pane" id="suspenciones">
                            <div class="row" style="margin-top:0.5rem; font-size: 0.8rem;">
                                    <div class="col-sm-12">
                                        <div class="card shadow">
                                            <div class="card-body">
                                                <div class="table-responsive">
                                                    <table class="table table-bordered" id="dataTable4" width="100%" cellspacing="0">
                                                        <thead>
                                                            <tr>
                                                                <th>Numero Orden</th>
                                                                <th>Deuda</th>
                                                                <th>Fecha expedicion</th>
                                                                <th>Fecha ejecucion</th>
                                                                <th>Generado</th>
                                                                <th>Estado</th>
                                                                <th>Usuario encargado</th>
                                                                <th>Referencia</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            {% for ord in suspenciones %}
                                                                <tr class="odd gradeX">
                                                                    <td>{{ ord.IdOrden }}</td>
                                                                    <td>{{ ord.Deuda }}</td>
                                                                    <td>{{ ord.FechaExpe }}</td>
                                                                    <td>{{ ord.FechaEjecucion }}</td>
                                                                    <td>{{ ord.Generado }}</td>
                                                                    <td>{{ ord.Estado }}</td>
                                                                    <td>{{ ord.UsuarioEjecuta }}</td>
                                                                    <td>{{ ord.IdEstadoCuenta }}</td>
                                                                </tr>
                                                            {% endfor %}
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div> 
                        </div>
                        <div class="tab-pane" id="reconexiones">
                                                            <div class="row" style="margin-top:0.5rem; font-size: 0.8rem;">
                                    <div class="col-sm-12">
                                        <div class="card shadow">
                                            <div class="card-body">
                                                <div class="table-responsive">
                                                    <table class="table table-bordered" id="dataTable5" width="100%" cellspacing="0">
                                                        <thead>
                                                            <tr>
                                                                <th>Numero Orden</th>
                                                                <th>Deuda</th>
                                                                <th>Fecha expedicion</th>
                                                                <th>Fecha ejecucion</th>
                                                                <th>Generado</th>
                                                                <th>Estado</th>
                                                                <th>Usuario encargado</th>
                                                                <th>Referencia</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            {% for ord in reconexion %}
                                                                <tr class="odd gradeX">
                                                                    <td>{{ ord.IdOrden }}</td>
                                                                    <td>{{ ord.Deuda }}</td>
                                                                    <td>{{ ord.FechaExpe }}</td>
                                                                    <td>{{ ord.FechaEjecucion }}</td>
                                                                    <td>{{ ord.Generado }}</td>
                                                                    <td>{{ ord.Estado }}</td>
                                                                    <td>{{ ord.UsuarioEjecuta }}</td>
                                                                    <td>{{ ord.IdEstadoCuenta }}</td>
                                                                </tr>
                                                            {% endfor %}
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div> 
                        </div>
                        <div class="tab-pane" id="ocobros">
                                                             <div class="row" style="margin-top:0.5rem; font-size: 0.8rem;">
                                    <div class="col-sm-12">
                                        <div class="card shadow">
                                            <div class="card-body">
                                                <div class="table-responsive">
                                                    <table class="table table-bordered" id="dataTable6" width="100%" cellspacing="0">
                                                        <thead>
                                                            <tr>
                                                                <th>Numero Orden</th>
                                                                <th>Fecha</th>
                                                                <th>Estado</th>
                                                                <th>Valor</th>
                                                                <th>Id suspencion</th>
                                                                <th>Tipo de orden</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            {% for ord in ordenesrs %}
                                                                <tr class="odd gradeX">
                                                                    <td>{{ ord.IdOrden }}</td>
                                                                    <td>{{ ord.Fecha }}</td>
                                                                    <td>{{ ord.Estado }}</td>
                                                                    <td>{{ ord.Valor}}</td>
                                                                    <td>{{ ord.IdOrdenT }}</td>
                                                                    <td>{{ ord.TipoOrden }}</td>
                                                                </tr>
                                                            {% endfor %}
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div> 
                        </div>
                      <div class="tab-pane" id="tabs-settings-7">
                        <div>
                            <div class="btn-group" role="group" style="margin-top:0.3rem;">
                                <button id="btnGroupDrop1" type="button" class="btn btn-primary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Otras opciones
                                </button>
                                <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                                   <a class="dropdown-item" href="{% url 'usuarios:cambiotitular' matricula %}">Cambiar propietario</a>
                                    <a class="dropdown-item" href="{% url 'usuarios:facturaindividual' matricula %}">Generar factura</a>
                                                {% for medidor in medidores %}
                                                &nbsp;&nbsp;
                                                {% empty %}
                                                <a class="dropdown-item" href="{% url 'usuarios:registromedidor' matricula %}">Asignar Medidor</a>
                                                {%endfor%}

                                                {% for cobro in cobromatricula %}
                                                <a class="dropdown-item" href="{% url 'usuarios:pagarmatricula' matricula %}">Pago matricula</a>
                                                {% empty %}
                                                &nbsp;&nbsp;
                                                {%endfor%}

                                </div>
                            </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
        </div>
    </div>
</div>

{% endblock %}
{% block scripts %}
<script type="text/javascript">
    $(document).ready( function () {
    $('#dataTable2').DataTable();
} );
</script>
<script type="text/javascript">
    $(document).ready( function () {
    $('#dataTable3').DataTable();
} );
</script>
<script type="text/javascript">
    $(document).ready( function () {
    $('#dataTable4').DataTable();
} );
</script>
<script type="text/javascript">
    $(document).ready( function () {
    $('#dataTable5').DataTable();
} );
</script>
<script type="text/javascript">
    $(document).ready( function () {
    $('#dataTable6').DataTable();
} );
</script>
<script type="text/javascript">
    $(function () {
      $('[data-toggle="popover"]').popover()
    })
</script>
{% endblock %}